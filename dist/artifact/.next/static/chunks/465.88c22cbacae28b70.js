"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{5046:function(e,t,n){n.d(t,{Qe:function(){return l}});let r=new Set(["1","yes","true"]),i=new Set(["viz_init","viz_ready","viz_error","viz_lazy_mount","viz_prefetch","viz_destroyed","viz_fallback_engaged","viz_data_mapped","viz_motion_mode","viz_spec_load"]);function l(e,t){return function(e){if(function(){if("undefined"==typeof navigator)return!1;let e=navigator;return"boolean"==typeof e.globalPrivacyControl&&!!e.globalPrivacyControl||[e.doNotTrack,e.msDoNotTrack].some(e=>!!e&&r.has(String(e).toLowerCase()))}()||function(){let e=window.doNotTrack;return!!e&&r.has(String(e).toLowerCase())}())return!1;let t=function(){var e,t;if("undefined"==typeof document)return"necessary";for(let n of null!==(t=null===(e=document.cookie)||void 0===e?void 0:e.split(";"))&&void 0!==t?t:[]){let e=n.trim();if(!e)continue;let[t,...r]=e.split("=");if("sv_consent"!==t)continue;let i=r.join("=");try{let e=decodeURIComponent(i).trim().toLowerCase();if("all"===e)return"all";if("necessary"===e)break}catch(t){let e=i.trim().toLowerCase();if("all"===e)return"all";if("necessary"===e)break}}return"necessary"}();if("necessary"===t&&!e.isNecessary)return!1;let n={name:e.name,detail:e.detail,timestamp:new Date().toISOString(),consent:t};try{let t=e.transport(n);return!1!==t}catch(e){return!1}}({name:e,detail:t,isNecessary:i.has(e),transport:e=>{let{name:t,detail:n,timestamp:r}=e,i={...n,name:t,timestamp:r},l=new CustomEvent(t,{detail:i,bubbles:!1});return window.dispatchEvent(l),!0}})}},5465:function(e,t,n){n.r(t),n.d(t,{createMap:function(){return a},loadMapLibre:function(){return o},mapLibreAdapter:function(){return p}});var r=n(5046),i=n(518);let l=null;function o(){return l||(l=n.e(988).then(n.bind(n,1988))),l}async function a(e,t){return new(await o()).Map({container:e,...t})}function u(e){return e?"discrete":"animated"}function c(e){if("function"==typeof globalThis.structuredClone)try{return globalThis.structuredClone(e)}catch(e){}return{style:"string"==typeof e.style?e.style:JSON.parse(JSON.stringify(e.style)),camera:e.camera?{center:e.camera.center?[...e.camera.center]:void 0,zoom:e.camera.zoom,bearing:e.camera.bearing,pitch:e.camera.pitch,padding:e.camera.padding?{...e.camera.padding}:void 0}:void 0,layers:e.layers?e.layers.map(e=>({id:e.id,op:e.op,def:e.def?JSON.parse(JSON.stringify(e.def)):void 0})):void 0}}function d(e,t){let n=null==e?void 0:e.trim();if(!n||"0"===n)return 0;if(n.endsWith("px")){let e=Number.parseFloat(n);return Number.isFinite(e)?e:0}if(!(null==t?void 0:t.body))return 0;let r=t.createElement("div");r.style.position="absolute",r.style.visibility="hidden",r.style.width=n,r.style.height="0",r.style.padding="0",r.style.border="0",t.body.appendChild(r);let i=r.offsetWidth;return r.remove(),Number.isFinite(i)?i:0}function s(e,t){let n=function(e){var t,n;let r=null!==(t=e.ownerDocument)&&void 0!==t?t:null,i=null!==(n=null==r?void 0:r.defaultView)&&void 0!==n?n:null;if(!r||!i)return 0;let l=i.getComputedStyle(e).getPropertyValue("--sticky-top");return l.trim()?d(l,r):d(i.getComputedStyle(r.documentElement).getPropertyValue("--sticky-top"),r)}(e);if(!t&&n<=0)return;let r=t?{...t}:{};if(n>0){var i;r.top=(null!==(i=r.top)&&void 0!==i?i:0)+n}let l=Object.entries(r).filter(e=>{let[,t]=e;return"number"==typeof t&&Number.isFinite(t)});if(0!==l.length)return Object.fromEntries(l)}function f(e,t,n,r){let i=e.map;i&&(r&&!function(e,t){if("string"==typeof e||"string"==typeof t)return e===t;try{return JSON.stringify(e)===JSON.stringify(t)}catch(e){return!1}}(r.style,t.style)&&i.setStyle(t.style,{diff:!n}),function(e,t,n){if(!t)return;let r=e.container,i=e.map;if(!r||!i)return;let l=s(r,t.padding),o={};if(t.center&&(o.center=t.center),"number"==typeof t.zoom&&(o.zoom=t.zoom),"number"==typeof t.bearing&&(o.bearing=t.bearing),"number"==typeof t.pitch&&(o.pitch=t.pitch),l&&(o.padding=l),0!==Object.keys(o).length){if(!n&&"function"==typeof i.easeTo){i.easeTo({...o});return}if("function"==typeof i.jumpTo){i.jumpTo(o);return}if(o.center&&i.setCenter(o.center),"number"==typeof o.zoom&&i.setZoom(o.zoom),"number"==typeof o.pitch&&i.setPitch(o.pitch,{duration:n?0:void 0}),"number"==typeof o.bearing&&i.setBearing(o.bearing,{duration:n?0:void 0}),o.padding){var a;null===(a=i.setPadding)||void 0===a||a.call(i,o.padding)}}}(e,t.camera,n),function(e,t){if(null==t?void 0:t.length)for(let u of t){var n,r,i,l,o,a;let t=null===(n=e.getLayer)||void 0===n?void 0:n.call(e,u.id);if("remove"===u.op){t&&(null===(i=e.removeLayer)||void 0===i||i.call(e,u.id));continue}let c=u.def;if(!c)continue;"update"===u.op&&t&&(null===(l=e.removeLayer)||void 0===l||l.call(e,u.id)),"add"===u.op&&t&&(null===(o=e.removeLayer)||void 0===o||o.call(e,u.id));let d="object"==typeof c&&null!==c&&null!==(a=c.source)&&void 0!==a?a:void 0;(!d||"function"!=typeof e.getSource||e.getSource(d))&&(null===(r=e.addLayer)||void 0===r||r.call(e,c))}}(i,t.layers))}let p={async mount(e,t,n){var l,a,d,p,m;if(!(0,i.d_)()){let l=c(t),o=(0,i.Np)(e,{lib:"maplibre",title:"Режим совместимости",message:"Интерактивная карта недоступна в этом браузере.",note:"Карта требует WebGL. Показан статичный режим без интерактивности."});return(0,r.Qe)("viz_fallback_engaged",{lib:"maplibre",motion:u(n.discrete),reason:"webgl",fallback:"static"}),{map:null,container:e,spec:l,discrete:n.discrete,cleanup:o?[o]:[]}}let y=await o(),b=c(t),g=s(e,null===(l=b.camera)||void 0===l?void 0:l.padding),v={container:e,style:b.style,center:null===(a=b.camera)||void 0===a?void 0:a.center,zoom:null===(d=b.camera)||void 0===d?void 0:d.zoom,bearing:null===(p=b.camera)||void 0===p?void 0:p.bearing,pitch:null===(m=b.camera)||void 0===m?void 0:m.pitch,padding:g},h=new(function(e){if("function"==typeof e)return e;if(e&&"function"==typeof e.Map)return e.Map;let t=e.default;if("function"==typeof t)return t;if(t&&"function"==typeof t.Map)return t.Map;throw Error("MapLibre constructor not found")}(y))(v),w={map:h,container:e,spec:b,discrete:n.discrete,cleanup:[]},z=function(e){let t=e.map;if(!t)return()=>{};let n=t=>{var n;let i=null!==(n=function(e){if(e){if("string"==typeof e)return e;if(e instanceof Error)return e.message;if("object"==typeof e){let t=e.message;if("string"==typeof t)return t;let n=e.error;if("string"==typeof n)return n;if(n instanceof Error)return n.message;if("object"==typeof n&&n){let e=n.message;if("string"==typeof e)return e}}}}(t))&&void 0!==n?n:"Unknown MapLibre error";(0,r.Qe)("viz_error",{lib:"maplibre",motion:u(e.discrete),reason:"runtime",error:i})};return t.on("error",n),()=>{t.off("error",n)}}(w);w.cleanup.push(z);let C=function(e,t){var n,r;let i=globalThis.ResizeObserver;if("function"!=typeof i)return null;let l=null!==(r=null===(n=t.ownerDocument)||void 0===n?void 0:n.defaultView)&&void 0!==r?r:globalThis,o=null,a=!1,u=()=>{null!==o&&(l.clearTimeout(o),o=null),a=!1},c=()=>{if(null===o){e.resize(),o=l.setTimeout(()=>{o=null,a&&(a=!1,c())},150);return}a=!0},d=new i(()=>{c()});return d.observe(t),()=>{d.disconnect(),u()}}(h,e);return C&&w.cleanup.push(C),await ("function"==typeof h.isStyleLoaded&&h.isStyleLoaded()?Promise.resolve():new Promise(e=>{let t=()=>{h.off("load",t),e()};h.on("load",t)})),f(w,b,n.discrete),h.resize(),w},applyState(e,t,n){let r=e.spec;if(!e.map||!r)return;let i=c(r),l=c("function"==typeof t?t(i):t);e.spec=l,e.discrete=n.discrete,f(e,l,n.discrete,null!=r?r:void 0)},destroy(e){for(var t;e.cleanup.length>0;){let t=e.cleanup.pop();try{null==t||t()}catch(e){}}e.cleanup.length=0,null===(t=e.map)||void 0===t||t.remove(),e.map=null,e.container=null,e.spec=null,e.discrete=!1}}},518:function(e,t,n){n.d(t,{Np:function(){return c},d_:function(){return u},gd:function(){return a}});let r=null,i=null;function l(){return"undefined"==typeof document?null:document}function o(e,t){try{return e.getContext(t)}catch(e){return null}}let a=()=>null!==r?r:r=function(e){let t=l();if(!t)return!1;let n=t.createElement("canvas");n.width=1,n.height=1;try{let t=o(n,e);return null!==t}finally{"function"==typeof n.remove&&n.remove()}}("webgl2"),u=()=>{if(null!==i)return i;if(a())return i=!0,!0;let e=l();if(!e)return i=!1,!1;let t=e.createElement("canvas");t.width=1,t.height=1;try{let e=o(t,"webgl")||o(t,"experimental-webgl");return i=null!==e}finally{"function"==typeof t.remove&&t.remove()}};function c(e,t){var n,r,i,o;let a=null!==(o=e.ownerDocument)&&void 0!==o?o:l();if(!a)return()=>{};for(;e.firstChild;)e.removeChild(e.firstChild);e.setAttribute("data-viz-fallback","webgl"),e.setAttribute("data-viz-fallback-lib",t.lib);let u=a.createElement("div");u.className="viz-compat-fallback",u.dataset.vizFallback="webgl",u.dataset.vizFallbackLib=t.lib,u.setAttribute("role","group"),u.setAttribute("aria-label",null!==(n=t.title)&&void 0!==n?n:"Режим совместимости"),u.style.display="flex",u.style.flexDirection="column",u.style.alignItems="center",u.style.justifyContent="center",u.style.gap="0.75rem",u.style.width="100%",u.style.height="100%",u.style.minHeight="220px",u.style.boxSizing="border-box",u.style.padding="1.5rem",u.style.borderRadius="0.75rem",u.style.border="1px solid rgba(148, 163, 184, 0.35)",u.style.background="linear-gradient(135deg, rgba(15, 23, 42, 0.04), rgba(148, 163, 184, 0.08))",u.style.color="rgba(15, 23, 42, 0.78)",u.style.textAlign="center",u.style.fontSize="0.9375rem",u.style.lineHeight="1.5";let c=a.createElement("div");c.setAttribute("aria-hidden","true"),c.style.width="min(260px, 90%)",c.style.aspectRatio="4 / 3",c.style.borderRadius="0.5rem",c.style.background="repeating-linear-gradient(45deg, rgba(148, 163, 184, 0.25) 0, rgba(148, 163, 184, 0.25) 12px, rgba(148, 163, 184, 0.1) 12px, rgba(148, 163, 184, 0.1) 24px)";let d=a.createElement("p");d.textContent=null!==(r=t.title)&&void 0!==r?r:"Режим совместимости",d.style.margin="0",d.style.fontWeight="600",d.style.fontSize="1rem";let s=a.createElement("p");s.textContent=t.message,s.style.margin="0",s.style.maxWidth="36ch";let f=a.createElement("p");return f.textContent=null!==(i=t.note)&&void 0!==i?i:"Интерактивная визуализация требует поддержки WebGL.",f.style.margin="0",f.style.maxWidth="40ch",f.style.fontSize="0.875rem",f.style.color="rgba(15, 23, 42, 0.62)",u.appendChild(c),u.appendChild(d),u.appendChild(s),u.appendChild(f),e.appendChild(u),()=>{u.parentNode===e&&e.removeChild(u),e.childNodes.length||(e.removeAttribute("data-viz-fallback"),e.removeAttribute("data-viz-fallback-lib"))}}}}]);